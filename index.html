<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Companion Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1193737173089001" crossorigin="anonymous"></script>
    <!-- React + ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
      const API_KEY = "AIzaSyCQ2khBaHj_lxj1UCuzpQeWLdCeYO7Q_cc"; // <-- apna YouTube API key yaha daalo

      // ---------------- Header ----------------
      function Header({ onSearch }) {
        return (
          <header className="bg-red-600 text-white p-4 flex justify-between items-center">
            <h1 className="text-xl font-bold">YouTube Companion</h1>
            <input
              type="text"
              placeholder="Search..."
              className="px-3 py-1 rounded text-black"
              onChange={(e) => onSearch(e.target.value)}
            />
          </header>
        );
      }

      // ---------------- Sidebar ----------------
      function Sidebar({ currentPage, setPage }) {
        const menu = [
          { name: "Home", icon: "üè†" },
          { name: "Search", icon: "üîç" },
          { name: "Watch", icon: "‚ñ∂Ô∏è" },
          { name: "Library", icon: "üìö" },
          { name: "Channels", icon: "üì∫" },
        ];

        return (
          <aside className="bg-gray-900 text-white w-64 min-h-screen p-4 space-y-4">
            <div className="font-bold text-lg">Menu</div>
            <ul className="space-y-2">
              {menu.map((item) => (
                <li
                  key={item.name}
                  className={`p-2 rounded cursor-pointer ${
                    currentPage === item.name ? "bg-gray-700" : "hover:bg-gray-700"
                  }`}
                  onClick={() => setPage(item.name)}
                >
                  {item.icon} {item.name}
                </li>
              ))}
            </ul>
          </aside>
        );
      }

      // ---------------- VideoCard ----------------
      function VideoCard({ video, onSelect }) {
        const videoId = video.id.videoId || video.id;
        return (
          <div
            className="bg-white shadow rounded overflow-hidden cursor-pointer hover:shadow-lg"
            onClick={() => onSelect(videoId)}
          >
            <img
              src={video.snippet.thumbnails.medium.url}
              alt={video.snippet.title}
              className="w-full h-40 object-cover"
            />
            <div className="p-2">
              <h2 className="font-semibold line-clamp-2">{video.snippet.title}</h2>
              <p className="text-sm text-gray-600">{video.snippet.channelTitle}</p>
            </div>
          </div>
        );
      }

      // ---------------- VideoGrid ----------------
      function VideoGrid({ videos, loading, onSelect }) {
        if (loading) return <Loader />;
        if (!videos.length) return <EmptyState text="No videos found." />;

        return (
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 p-4">
            {videos.map((v) => (
              <VideoCard key={v.id.videoId || v.id} video={v} onSelect={onSelect} />
            ))}
          </div>
        );
      }

      // ---------------- ChannelPill ----------------
      function ChannelPill({ name }) {
        return (
          <span className="bg-gray-200 px-3 py-1 rounded-full text-sm mr-2">
            {name}
          </span>
        );
      }

      // ---------------- Loader ----------------
      function Loader() {
        return (
          <div className="flex justify-center items-center p-6">
            <div className="animate-spin rounded-full h-10 w-10 border-t-2 border-red-600"></div>
          </div>
        );
      }

      // ---------------- EmptyState ----------------
      function EmptyState({ text }) {
        return (
          <div className="text-gray-500 text-center p-6">
            {text || "Nothing here yet!"}
          </div>
        );
      }

      // ---------------- Pages ----------------
      function Home({ videos, loading, onSelect }) {
        return (
          <div>
            <h2 className="text-xl font-bold p-4">üî• Trending</h2>
            <VideoGrid videos={videos} loading={loading} onSelect={onSelect} />
          </div>
        );
      }

      function Search({ query, results, loading, onSelect }) {
        return (
          <div>
            <h2 className="text-xl font-bold p-4">
              {query ? `üîç Results for "${query}"` : "Search Videos"}
            </h2>
            <VideoGrid videos={results} loading={loading} onSelect={onSelect} />
          </div>
        );
      }

      function Watch({ videoId }) {
        if (!videoId) return <EmptyState text="‚ñ∂Ô∏è Select a video to watch." />;
        return (
          <div className="p-4">
            <div className="aspect-w-16 aspect-h-9">
              <iframe
                className="w-full h-[500px] rounded"
                src={`https://www.youtube.com/embed/${videoId}`}
                frameBorder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowFullScreen
              ></iframe>
            </div>
          </div>
        );
      }

      function Library() {
        return <EmptyState text="üìö Your library is empty." />;
      }

      function Channels() {
        return (
          <div className="p-4">
            <h2 className="font-bold mb-2">üì∫ Followed Channels</h2>
            <ChannelPill name="React Devs" />
            <ChannelPill name="Music Mix" />
          </div>
        );
      }

      // ---------------- App ----------------
      function App() {
        const [page, setPage] = React.useState("Home");
        const [searchQuery, setSearchQuery] = React.useState("");
        const [trending, setTrending] = React.useState([]);
        const [searchResults, setSearchResults] = React.useState([]);
        const [loading, setLoading] = React.useState(false);
        const [currentVideo, setCurrentVideo] = React.useState(null);

        // Fetch trending videos
        React.useEffect(() => {
          async function fetchTrending() {
            setLoading(true);
            try {
              const res = await fetch(
                `https://www.googleapis.com/youtube/v3/videos?part=snippet&chart=mostPopular&maxResults=9&regionCode=IN&key=${API_KEY}`
              );
              const data = await res.json();
              setTrending(data.items || []);
            } catch (err) {
              console.error(err);
            }
            setLoading(false);
          }
          fetchTrending();
        }, []);

        // Fetch search results
        React.useEffect(() => {
          if (!searchQuery) return;
          async function fetchSearch() {
            setLoading(true);
            try {
              const res = await fetch(
                `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${searchQuery}&maxResults=9&type=video&key=${API_KEY}`
              );
              const data = await res.json();
              setSearchResults(data.items || []);
            } catch (err) {
              console.error(err);
            }
            setLoading(false);
          }
          fetchSearch();
        }, [searchQuery]);

        const handleSelectVideo = (videoId) => {
          setCurrentVideo(videoId);
          setPage("Watch");
        };

        let content;
        if (page === "Home")
          content = <Home videos={trending} loading={loading} onSelect={handleSelectVideo} />;
        if (page === "Search")
          content = (
            <Search
              query={searchQuery}
              results={searchResults}
              loading={loading}
              onSelect={handleSelectVideo}
            />
          );
        if (page === "Watch") content = <Watch videoId={currentVideo} />;
        if (page === "Library") content = <Library />;
        if (page === "Channels") content = <Channels />;

        return (
          <div className="flex">
            <Sidebar currentPage={page} setPage={setPage} />
            <div className="flex-1">
              <Header onSearch={setSearchQuery} />
              {content}
            </div>
          </div>
        );
      }

      // ---------------- Render ----------------
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
